<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.roowoo.log.modules.count6laccountmessage.dao.Count6lAccountMesssageDao">
    
	<sql id="count6lAccountMesssageColumns">
		a.account AS "account",
		a.depart AS "depart",
		a.load_date AS "loadDate",
		a.load_state AS "loadState",
		a.source_address AS "sourceAddress",
		a.target_address AS "targetAddress"
	</sql>
	
	<sql id="count6lAccountMesssageJoins">
	</sql>
    
	<select id="get" resultType="Count6lAccountMesssage">
		SELECT 
			<include refid="count6lAccountMesssageColumns"/>
		FROM count6l_account_messsage a
		<include refid="count6lAccountMesssageJoins"/>
		WHERE a.id = #{id}
	</select>
	
	<select id="findList" resultType="Count6lAccountMesssage">
		SELECT 
			<include refid="count6lAccountMesssageColumns"/>
		FROM count6l_account_messsage a
		<include refid="count6lAccountMesssageJoins"/>
		<where>
			
			<if test="account != null and account != ''">
				AND a.account LIKE 
					<if test="dbName == 'oracle'">'%'||#{account}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{account}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{account},'%')</if>
			</if>
			<if test="depart != null and depart != ''">
				AND a.depart LIKE 
					<if test="dbName == 'oracle'">'%'||#{depart}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{depart}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{depart},'%')</if>
			</if>
			<if test="loadDate != null and loadDate != ''">
				AND a.load_date &gt;= #{loadDate}
				AND a.load_date &lt;= #{loadDate1}
			</if>
			<if test="loadState != null and loadState != ''">
				AND a.load_state = #{loadState}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<select id="findAllList" resultType="Count6lAccountMesssage">
		SELECT 
			<include refid="count6lAccountMesssageColumns"/>
		FROM count6l_account_messsage a
		<include refid="count6lAccountMesssageJoins"/>
		<where>
			
		</where>		
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<insert id="insert">
		INSERT INTO count6l_account_messsage(
			account,
			depart,
			load_date,
			load_state,
			source_address,
			target_address
		) VALUES (
			#{account},
			#{depart},
			#{loadDate},
			#{loadState},
			#{sourceAddress},
			#{targetAddress}
		)
	</insert>
	
	<update id="update">
		UPDATE count6l_account_messsage SET 	
			account = #{account},
			depart = #{depart},
			load_date = #{loadDate},
			load_state = #{loadState},
			source_address = #{sourceAddress},
			target_address = #{targetAddress}
		WHERE id = #{id}
	</update>
	
	<update id="delete">
		DELETE FROM count6l_account_messsage
		WHERE id = #{id}
	</update>
	
</mapper>